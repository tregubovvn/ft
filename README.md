# Formula Builder
https://tregubovvn.github.io/ft/index.html?file=https://tregubovvn.github.io/ft/op/t2.xml 

**Formula Builder** — это интерактивное HTML-приложение для проверки знаний математических и физических формул. Приложение позволяет студентам собирать формулы из фрагментов, загружать задания из внешних источников и автоматически отправлять результаты тестирования.

Приложение реализовано в виде одного HTML-файла, не требует установки серверного ПО и работает в любом современном браузере.

---

## Основные возможности

### 1. Гибкая загрузка данных
Поддерживается несколько способов загрузки формул для максимального удобства преподавателей и студентов:
*   **Локальный файл**: Загрузка XML-файла с диска компьютера (Drag & Drop или выбор файла).
*   **Прямая ссылка (URL)**: Загрузка файла по протоколам HTTP/HTTPS.
*   **Яндекс.Диск**: Автоматическая интеграция с публичными ссылками Яндекс.Диска. Приложение самостоятельно преобразует ссылку на файл в ссылку для скачивания через API Яндекса.
*   **QR-код**: Сканирование QR-кода с помощью камеры устройства для моментальной загрузки файла с формулами.
*   **URL-параметры**: Возможность передать ссылку на файл или даже одну формулу непосредственно через адресную строку браузера.

### 2. Интерактивный процесс тестирования
*   **Сборка формулы**: Студент не выбирает вариант ответа, а собирает формулу из перемешанных фрагментов (LaTeX-блоков).
*   **Скрытый ответ**: Правильный вариант формулы не отображается во время теста — студент должен вспомнить формулу по её названию.
*   **Условные обозначения**: Приложение отображает список переменных и констант, используемых в формуле, с их расшифровкой (поддерживается формат XML).
*   **Drag & Drop**: Интуитивный интерфейс перетаскивания фрагментов. Также поддерживается клик для перемещения фрагментов.
*   **Адаптивность**: Интерфейс корректно отображается на десктопах, планшетах и смартфонах.

### 3. Учет времени и оценивание
*   **Секундомер**: Время прохождения теста фиксируется и отображается в режиме реального времени.
*   **Детализация**: После завершения теста студент видит свой процент правильных ответов, количество ошибок и детальный разбор каждой формулы.
*   **Отложенная проверка**: Проверка происходит только после нажатия кнопки "Проверить", что позволяет студенту корректировать ответ.

### 4. Интеграция и отчетность
*   **Отправка результатов**: Автоматическая отправка итогов тестирования во внешнюю систему (Яндекс.Формы, Google Таблицы через Webhook и др.).
*   **Валидация**: Проверка корректности порядка фрагментов.

---

## Технические детали

### Формат XML файла
Приложение работает с XML-файлами следующей структуры:

#### Базовый формат
```xml
<formulas>
    <formula name="Теорема Пифагора">a^2 + b^2 = c^2</formula>
    <formula name="Квадратное уравнение">x = \frac{-b \pm \sqrt{b^2-4ac}}{2a}</formula>
</formulas>
```

#### Расширенный формат (с условными обозначениями)
Для отображения подсказок используйте вложенные теги `<latex>` и `<symbols>`:

```xml
<formulas>
    <formula name="Кинетическая энергия">
        <latex>E_k = \frac{mv^2}{2}</latex>
        <symbols>
            <symbol char="E_k" name="кинетическая энергия" />
            <symbol char="m" name="масса тела" />
            <symbol char="v" name="скорость тела" />
        </symbols>
    </formula>
</formulas>
```

### Использование URL-параметров
Приложение поддерживает управление через параметры строки запроса (Query String):

| Параметр | Описание | Пример |
| :--- | :--- | :--- |
| `file` | Ссылка на XML файл (поддерживает Яндекс.Диск). | `?file=https://disk.yandex.ru/d/xxxxx` |
| `formula` | Одна формула в формате LaTeX (для быстрого теста). | `?formula=a^2+b^2=c^2&name=Пифагор` |
| `form_url` | URL для отправки результатов (GET-запрос). | `?form_url=https://forms.yandex.ru/u/...` |

**Пример готовой ссылки для теста:**
```text
https://mysite.com/formula.html?file=https://disk.yandex.ru/d/123456&form_url=https://hook.integromat.com/abc
```

### Отправка результатов (Integration)
Если в URL задан параметр `form_url`, приложение выполнит GET-запрос по этому адресу при завершении теста. Параметры запроса:
*   `student` — Фамилия и Имя.
*   `score` — Результат (например, "5/5").
*   `percentage` — Процент правильных ответов.
*   `time` — Время прохождения (MM:SS).
*   `date` — Дата и время завершения.

Это позволяет интегрировать приложение с сервисами автоматизации (Make, Zapier) или формами (Яндекс.Формы).

---

## Алгоритм работы

1.  **Регистрация**: Студент вводит Фамилию и Имя.
2.  **Загрузка**: Приложение загружает XML, парсит его и перемешивает порядок формул.
3.  **Тестирование**:
    *   Отображается название формулы и список обозначений.
    *   Формула разбивается на фрагменты (с учетом синтаксиса LaTeX).
    *   Фрагменты перемешиваются.
    *   Студент собирает формулу в поле "Ваш ответ".
4.  **Проверка**: Последовательность фрагментов сравнивается с эталонной.
5.  **Результат**: Отображается статистика, и (если настроено) отправляется отчет.

---

## Технологический стек

*   **HTML5 / CSS3 / JavaScript (ES6)** — основа приложения.
*   **KaTeX** — быстрый рендеринг математических формул.
*   **jsQR** — библиотека для сканирования QR-кодов.
*   **Tailwind CSS** — стилизация интерфейса.
*   **Yandex Disk API** — для получения прямых ссылок на скачивание файлов.

---

## Рекомендации по использованию

1.  Для проведения массового тестирования разместите HTML-файл на сервере вашего учебного заведения или в любом облачном хранилище, поддерживающем хостинг статики.
2.  Храните файлы с формулами на Яндекс.Диске, выкладывая публичные ссылки.
3.  Используйте сервисы автоматизации (например, Make) для сбора результатов из параметров `form_url` в Google Таблицы или базу данных.
```
